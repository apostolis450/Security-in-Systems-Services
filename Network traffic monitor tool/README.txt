-----------------------------------------------------------------------------------------
HRY414: Assignment 6	--	Network traffic monitoring using the Packet Capture library
Author: Apostolos Zacharopoulos
SID:    2015030128
Date:   16/12/2020
-----------------------------------------------------------------------------------------
Compile:
    make
Run:
    ./nwmonitor -i <dev> (for me it was ethernet device with name enp9s0)
--εδώ πρέπει να διακοπεί δίνοντας interrupt signal CTRL+C !!!
    
    ./nwmonitor -r <filname> (I used the given "test_pcap_5mins.pcap" file)
--σταματάει στο τέλος του αρχείου

Comments:
Υλοποιήθηκαν όλες οι λειτουργίες που ζητήθηκαν, εκτός απο τον
εντοπισμό επαναμετάδοσης πακέτου. Ισχύει ότι το πεδίο sequence του 
stuct tcp header περιέχει τον αύξοντα αριθμό της αποστολής του κάθε πακέτου.
Ενώ τα πακέτα TCP κρατάνε περισσότερη πληροφορία όσον αφορά το flow τους,
τα UDP πακέτα είναι περισσότερο low-level και δεν έχουν αυτή την πληροφορία.
Έπειτα απο αναζήτηση, φαίνεται πως είναι πιο περίπλοκο να εντοπίσεις ένα 
retransmmited udp πακέτο. Η ίδεα θα ήταν να ελέγχω άν ένα πακέτο,ξαναστέλνεται
απο την ίδια ip:port στην ίδια ip:port και έχει το ίδιο sequence number την 2η
ή και περισσότερες φορές, πέραν την πρώτης αποστολής του.

Χρησιμοποιείται η pcap_loop και για τις δυο λειτουργίες, καλώντας την callback
σε κάθε νέο πακέτο.Ελέγχεται αρχικά αν το πακέτο ειναι over ethernet είτε 
IPv4 είτε IPv6 και έπειτα διαχωρίζονται.Κάνοντας τις κατάλληλες πράξεις,
παιρνουμε τις πληροφορίες απο το κάθε πακέτο.
Στην λειτουργία device, διαβάζει συνεχώς πακέτα μέχρις ώτου το διακόψουμε
με CTRL+C εμείς.